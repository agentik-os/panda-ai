# Coverage Baseline - 2026-02-14

**Generated by:** testing-lead
**Target:** >80% coverage across all packages

---

## Summary

| Package | Statements | Branches | Functions | Lines | Status |
|---------|-----------|----------|-----------|-------|--------|
| **Runtime** | 71.27% | 63.07% | 76.93% | 71.77% | ðŸŸ¡ Close |
| **CLI** | 48.17% | 44.44% | 55.83% | 47.75% | ðŸ”´ Needs Work |
| **Dashboard** | N/A | N/A | N/A | N/A | ðŸ“‹ E2E Only |
| **SDK** | 0% | 0% | 0% | 0% | ðŸ”´ No Tests |
| **Skills** | ~90%+ | ~85%+ | ~95%+ | ~90%+ | âœ… Good |
| **TOTAL** | ~60-70% | ~55-65% | ~70-80% | ~60-70% | ðŸ”´ Below Target |

---

## Runtime Package (71.27% coverage)

### Critical Gaps (<50% coverage)

| File | Coverage | Priority |
|------|----------|----------|
| `src/convex-client.ts` | 14.28% | ðŸ”´ HIGH |
| `src/automations/intent-classifier.ts` | 0% | ðŸ”´ CRITICAL |
| `src/websocket/server.ts` | 25.64% | ðŸ”´ HIGH |
| `src/pipeline/load-memory.ts` | 18.18% | ðŸ”´ HIGH |
| `src/pipeline/orchestrator.ts` | 26.66% | ðŸ”´ HIGH |
| `src/websocket/types.ts` | 25% | ðŸŸ¡ MEDIUM |

### Medium Gaps (50-70% coverage)

| File | Coverage | Priority |
|------|----------|----------|
| `src/channels/cli.ts` | 45.16% | ðŸŸ¡ MEDIUM |
| `src/channels/discord.ts` | 48.29% | ðŸŸ¡ MEDIUM |
| `src/channels/telegram.ts` | 50.73% | ðŸŸ¡ MEDIUM |
| `src/channels/webhook.ts` | 45.28% | ðŸŸ¡ MEDIUM |
| `src/automations/parser.ts` | 53.46% | ðŸŸ¡ MEDIUM |
| `src/storage/convex-adapter.ts` | 53.42% | ðŸŸ¡ MEDIUM |
| `src/dreams/insight-generator.ts` | 64.15% | ðŸŸ¡ MEDIUM |
| `src/dreams/pattern-detector.ts` | 63.55% | ðŸŸ¡ MEDIUM |
| `src/mcp/client.ts` | 62.85% | ðŸŸ¡ MEDIUM |

### Good Coverage (>85%)

| File | Coverage | Status |
|------|----------|--------|
| `src/cost/calculator.ts` | 100% | âœ… |
| `src/cost/event-store.ts` | 100% | âœ… |
| `src/payments/revenue-split.ts` | 100% | âœ… |
| `src/router/providers/anthropic.ts` | 100% | âœ… |
| `src/router/providers/openai.ts` | 100% | âœ… |
| `src/router/complexity.ts` | 97.22% | âœ… |
| `src/skills/permissions.ts` | 99.18% | âœ… |
| `src/sandbox/permissions.ts` | 100% | âœ… |

---

## CLI Package (48.17% coverage)

### Critical Gaps (0% coverage)

| File | Coverage | Priority |
|------|----------|----------|
| `src/index.ts` | 0% | ðŸ”´ CRITICAL |
| `src/commands/deploy.ts` | 0% | ðŸ”´ HIGH |
| `src/commands/metrics.ts` | 0% | ðŸ”´ HIGH |
| `src/commands/publish.ts` | 0% | ðŸ”´ HIGH |
| `src/commands/skill/install.ts` | 0% | ðŸ”´ HIGH |
| `src/commands/skill/list.ts` | 0% | ðŸ”´ HIGH |
| `src/commands/skill/uninstall.ts` | 0% | ðŸ”´ HIGH |
| `src/ui/chat-interface.ts` | 0% | ðŸ”´ HIGH |
| `src/utils/skill-validator.ts` | 0% | ðŸ”´ HIGH |
| `src/utils/uploader.ts` | 0% | ðŸ”´ HIGH |

### Medium Gaps (30-50% coverage)

| File | Coverage | Priority |
|------|----------|----------|
| `src/commands/init.ts` | 35.71% | ðŸŸ¡ MEDIUM |

### Good Coverage (>85%)

| File | Coverage | Status |
|------|----------|--------|
| `src/commands/agent/create.ts` | 92.68% | âœ… |
| `src/commands/agent/list.ts` | 100% | âœ… |
| `src/commands/chat.ts` | 87.5% | âœ… |
| `src/commands/logs.ts` | 94.33% | âœ… |
| `src/commands/dreams/*` | 88.54% avg | âœ… |
| `src/commands/time-travel/*` | 93.39% avg | âœ… |
| `src/commands/workspace/*` | 86.03% avg | âœ… |

---

## Action Items (Priority Order)

### Phase 1: Critical Gaps (Week 1)
1. âœ… Runtime: automations/intent-classifier.ts (0% â†’ >80%)
2. âœ… Runtime: websocket/server.ts (25% â†’ >80%)
3. âœ… Runtime: convex-client.ts (14% â†’ >80%)
4. âœ… CLI: skill commands (0% â†’ >80%)
5. âœ… CLI: deploy/metrics/publish commands (0% â†’ >80%)

### Phase 2: Medium Gaps (Week 2)
1. âœ… Runtime: channel adapters (45-50% â†’ >80%)
2. âœ… Runtime: automations/parser.ts (53% â†’ >80%)
3. âœ… Runtime: storage/convex-adapter.ts (53% â†’ >80%)
4. âœ… CLI: ui/chat-interface.ts (0% â†’ >80%)
5. âœ… CLI: utils (0% â†’ >80%)

### Phase 3: Integration & E2E (Week 3)
1. âœ… Multi-agent workflows
2. âœ… External API integration tests
3. âœ… Dashboard E2E (Playwright)
4. âœ… CLI E2E flows

### Phase 4: Performance & Security (Week 4)
1. âœ… Load testing (100 concurrent agents)
2. âœ… Security scans (WASM sandbox)
3. âœ… Secret detection (TruffleHog)
4. âœ… Performance benchmarks

---

## Coverage Improvement Estimates

### Runtime: 71% â†’ 85%
- Files to improve: 9 critical files
- Estimated tests needed: ~150 tests
- Estimated time: 40 hours

### CLI: 48% â†’ 85%
- Files to improve: 10 critical files
- Estimated tests needed: ~200 tests
- Estimated time: 50 hours

### Dashboard: TBD â†’ 80%
- Need baseline first
- Estimate after measurement

### SDK: TBD â†’ 80%
- Need baseline first
- Estimate after measurement

---

**Total Effort Estimate:** 90-120 hours to reach >80% coverage target
**Timeline:** 4 weeks (20-30 hours/week)

---

**Next Steps:**
1. Get dashboard & SDK coverage baselines
2. Create specific tasks for each file
3. Begin with critical gaps (Phase 1)
4. Track progress in TESTING-STRATEGY.md
